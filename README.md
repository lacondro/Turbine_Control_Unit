# Turbine_Control_Unit
## 터빈 엔진 작동 시나리오

이 시스템은 **RC 조종기** 또는 **웹 UI**를 통해 제어할 수 있으며, 기본적인 작동 흐름은 동일합니다.

### 1. 준비 및 연결

1. **전원 인가**: 사용자가 ESP32 컨트롤러에 전원을 켜면, 컨트롤러는 "afterburner"라는 이름의 Wi-Fi AP(액세스 포인트)를 생성합니다.
2. **Wi-Fi 연결**: 사용자는 스마트폰이나 PC를 이용해 "afterburner" Wi-Fi에 연결합니다 (비밀번호: `12345678`).
3. **웹 UI 접속**: 웹 브라우저를 열고 `http://afterburner.local` 또는 컨트롤러의 IP 주소로 접속하면, `index.html`로 만들어진 제어판 페이지가 나타납니다. 이 페이지는 WebSocket을 통해 컨트롤러와 실시간으로 통신합니다.

### 2. 자동 시동 시퀀스

사용자가 RC 조종기의 **Power 스위치**를 올리거나 웹 UI에서 **System Power ON** 버튼을 누르면, 시스템은 `ARMED` 상태가 되며 아래의 자동 시동 절차를 시작합니다.

1. **`GLOW_ON` (예열)**: 먼저 예열 플러그(Glow Plug)가 켜져 3초 동안 연소실을 데웁니다.
2. **`STARTER_ON` (터빈 회전)**: 예열이 끝나면 스타터 모터가 작동하여 터빈을 돌리기 시작합니다. 모터는 2초에 걸쳐 점차 목표 속도까지 가속한 후, 1초간 대기합니다.
3. **`FUEL_RAMP` (연료 분사)**: 스타터 모터가 안정되면, 연료 펌프가 작동하여 연료를 분사하기 시작합니다. 이때부터 시스템은 8초 안에 터빈 온도가 100°C 이상으로 오르는지 감시합니다. 만약 시간 내에 도달하지 못하면 시동 실패로 판단하고 `ERROR_STOP` 상태로 전환됩니다.
4. **`IGNITION_CHECK` (점화 확인)**: 온도가 100°C를 넘으면, 성공적인 점화를 확인하는 단계로 넘어갑니다. 5초 안에 온도가 300°C 이상으로 치솟아야 합니다.
5. **`RUNNING` (엔진 작동)**: 온도가 300°C를 넘으면 엔진이 자체적으로 구동되는 것으로 판단하고, 예열 플러그와 스타터 모터를 끕니다. 이제 엔진은 정상 작동 상태(`RUNNING`)가 됩니다.

### 3. 엔진 작동 중

- **스로틀 제어**: `RUNNING` 상태에서는 RC 조종기의 스로틀(Throttle) 스틱 위치에 따라 연료 펌프의 분사량이 조절되어 엔진의 추력이 결정됩니다.
- **안전 장치**: 시스템은 지속적으로 터빈 온도를 감시하며, 만약 750°C를 초과하면 엔진 보호를 위해 즉시 `ERROR_STOP` 상태로 전환됩니다.

### 4. 정상 종료 및 냉각

1. **`COOLING` (냉각)**: 사용자가 조종기의 Power 스위치를 내리거나 웹 UI에서 **System Power OFF**를 누르면, 연료 공급이 차단되고 `COOLING` 상태로 들어갑니다.
2. **후열 처리**: 엔진을 보호하기 위해, 5초 간격으로 1초씩 스타터 모터를 돌려 터빈 내부에 남은 열을 식혀줍니다.
3. **`IDLE` (대기)**: 터빈 온도가 100°C 이하로 충분히 떨어지면 냉각 절차가 완료되고, 시스템은 모든 작동을 멈춘 뒤 다음 시동을 기다리는 `IDLE` 상태로 돌아갑니다.

### 5. 비상 정지 및 리셋

- **`ERROR_STOP`**: 시동 실패, 엔진 과열 등 비정상적인 상황이 발생하면 시스템은 모든 장치를 끄고 `ERROR_STOP` 상태가 됩니다.
- **리셋**: 이 상태를 해제하고 다시 시동을 걸기 위해서는, 안전을 위해 조종기의 Power 스위치를 **'껐다 켰다 다시 끄는'** 동작을 해야만 시스템이 `IDLE` 상태로 리셋됩니다.